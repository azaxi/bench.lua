# bench.lua
Simple Lua CPU and I/O benchmark that works under ESP8266 NodeMCU, OpenWrt, Windows and Linux.

Cannot be complex as it would quickly run out of memory. Even as simple as it is, had to be tweaked to run on NodeMCU, and that only works when everything else is disabled and have full 40kB heap. It may work with less if precompiled into .lc I rename init.lua to init2.lua, reboot, run this benchmark and then rename init.lua back.

Strangely, test file sometimes fails to open, or write speed drops from 44kB/s to 17kB/s. If write I/O test fails to open file and reports 0kB/s, subsequent read test fails as well, as it relies on testfile generated by write test. This problem is random and disappears on second try. On other hand, flash writing speed decrease may be related to internal temperature because once writing becomes slow, it remains slow. Only when I come back to it later, it may be back to 44kB. I will speculate that turning off WiFi and letting it cool down may work.

This is my first attempt at NodeMCU. I am bit late to ESP8266, but ended up with some quantity on hand and trying to make them useful. Even though community moved to other platforms, ESP8266 is now well documented and every possible problem has been encountered and mentioned.

This benchmark is written with some extra code to run on other platforms so I can have reference point, I left some notes in header comment in script itself. There is also some convenience code (e.g. printf) I plucked from other project and could be easily removed, I did not realize NodeMCU would have issue with few hundred lines. Perhaps next time I come back to this.
